---
layout: post
title:  安卓杂项001
date:   2015-12-10 22:51:11
category: "android"
---

本次的android的代码是接手他人写的code，发现了一个比较典型的问题，就是很多的技术都开始滥用。

### 关于需求

因涉及具体情况，具体需求就不列出来了。

页面A，页面B，页面C，页面D

A是一个列表。

B是具体的信息显示。

C是另外一个页面，一组功能的列表。

D是C中的一个Item点击进入后的页面。

### 之前的实现

最开始的实现是这样的。

使用的技术是fragment，即将中间显示的部分作为fragment来插入，然后通过上下的navigation来做出回退及跳转。

### 讨论

有这样的一个流传在编程界的说法：

如果这个世界上所有的需求都不变化的话，那么所有的软件都将是完美的。

而且，仅仅看代码就会发现很多问题，首先一个是navigation右上的小菜单的选择跳转问题。

在不同的fragment加载的时候，这个小菜单是会变化并且会载入不同的fragment或者是显示不同的东西的。

这个时候，我们会发现一个问题：

当我在加载某个fragment的时候，比如是由A->B的时候，菜单变化，那么如果B的菜单跳转的话，那么这个点击事件的运行却是需要放到A这个fragment的容器中去，这样的情况是让人很迷惑的，我的操作不在我的管辖范围内。

### 重构是最好的解决办法

最近沉迷在Martin Fowler的重构一书中，果然好的软件都应该是需要重构的，不论是从代码还是从架构甚至是思想上。

这个从大的方面上来说：

首先，这些细节上的不同导致了我们没有必要必须用fragment来实现现有的功能。

其次，使用Activity之间的跳转，同时通过对于stack的操作就可以实现回退功能。

再次，如果想重用上下的navigation的code，可以使用提取代码的方式生成父类，再派生出来子类达到不同的效果和统一的UI风格就好了。

### 结束语

这个让我印象最深的就是这次的重构我大概将60%的代码都转移，挪动，甚至是删除重写。

草草的写完了其实我就是想睡觉啦，等有时间将代码再一点一点的贴上来。

（原创文章，转载请注明，谢谢）